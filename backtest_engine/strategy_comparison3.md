# ETF轮动策略研究(二)：高收益防御 vs 动量加速

本文旨在对比分析本次新增的两种改进型ETF轮动策略，并与原版策略进行横向测评。

**涉及策略：**
1.  `wy03`：[原版](https://www.joinquant.com/post/42673)，基准策略
2.  `gao`：`ETF_gao_modular.py`，高收益防御版，侧重于稳健与风控
3.  `acc`：`ETF_acc.py`，动量加速版，侧重于捕捉动量加速阶段的超额收益

## 一、策略逻辑概述

1. 原版 (wy03)
2. 高收益防御版 (gao)
    *   定位：稳健改良版，引入多重过滤器。
    *   核心逻辑：基础评分逻辑与wy03相似，但使用了加权线性回归 (WLS)，赋予近期数据更高权重。
    *   交易与风控：
        *   交易时间：10:30 (避开早盘波动)。
        *   数据利用：深度利用当日10:30前的实时价格与成交量。
    *   核心特征：
        1.  3日大跌保护：若近3日（含今日实时）任意一日跌幅剧烈，直接剔除。
        2.  成交量异常：若今日开盘一小时成交量相比历史均值异常放量，视为出货信号，直接剔除。
        3.  分数上限：剔除得分过高(>5)的ETF，认为其动量已透支。

3. 动量加速版 (acc)
    *   定位：激进进攻版，追逐“疯牛”。
    *   核心逻辑：在动量评分的基础上，引入“加速度”考核。
    *   交易与风控：
        *   交易时间：09:35 (早盘确认)。
        *   数据利用：基本依赖昨日收盘数据，9:35主要为了确认开盘不跌停/能成交。
    *   核心特征：
        *   动量加速机制：通常策略会回避得分过高的标的（恐高），但本策略反其道而行。若得分极高(>6)，只要满足今日得分 $\ge$ 昨日得分 $\times$ 1.2 (即动量还在加速)，则果断买入。这是一种针对主升浪末端的搏杀逻辑。

**策略特性对比表**

| 特性 | wy03 (基准) | gao (防御) | acc (加速) |
| :--- | :--- | :--- | :--- |
| **动量算法** | OLS (普通回归) | WLS (加权回归) | WLS (加权回归) |
| **交易时间** | 09:30 | 10:30 | 09:35 |
| **利用当日数据** | 否 | **是** (实时价/量) | 否 |
| **对待高分股** | 正常买入 | **剔除** (>5) | **追涨** (若加速) |
| **风险控制** | 无 | 强 (3日跌幅/放量) | 弱 (仅依赖动量) |

## 二、 新策略提案：融合自适应策略 (ETF_fusion)

基于上述对比，我们发现 `gao` 的部分防御逻辑（如剔除高分股）在疯牛行情中会跑输，而 `acc` 虽猛但缺乏保护。因此，我们提出并实现了一个融合版本。

**文件**：`ETFs/ETF_fusion.py`

**核心逻辑：资产级自适应 (Asset-Specific Adaptive)**
不依赖全局大盘判断，而是针对每个ETF单独进行“攻防判定”。

1.  **安全区模式 (Score <= 5)**：
    *   沿用 `gao` 的稳健逻辑。
    *   应用 **3日累计跌幅** 过滤（防止接飞刀）。
    *   应用 **开盘成交量异常** 过滤（防止高位放量出货）。

2.  **高压区模式 (Score > 5)**:
    *   进入“有条件接受”状态。
    *   **加速校验**：只有当 `Score_Today > Score_Yesterday * 1.05` 时才买入。
    *   **逻辑**：若动量在高位不仅没减弱，反而还在加速，说明进入主升浪（Breakout），此时解除封印追涨；否则视为“过热滞涨”，坚决剔除。

3.  **交易时点**：**10:00**。折中方案，避开9:30的假动作，又比10:30更早介入行情。

---

## 三、 未来优化方向：评分与择时研究

通过对现有的 Slope * R2 算法的反思，我们整理了以下优化路径：

### 1. 评分算法改进 (Scoring)
目前的 $Slope \times R^2$ 属于“平滑动量”，容易错过指数级暴涨。建议引入：
*   **多周期加权 (Composite Momentum)**：综合 $R_{20}, R_{60}, R_{120}$，避免单一窗口噪音。
*   **波动率调节 (Sharpe-like)**：$Score = Return / Volatility$。这是机构常用的“稳健动量”，在震荡市中能显著降低回撤。
*   **路径一致性 (ID)**：$|Ret_{total}| / \sum|Ret_{daily}|$。比 $R^2$ 更纯粹地衡量“上涨质量”。

### 2. 趋势跟踪增强 (Trend Following)
除了纯动量排名，建议引入更高级的择时信号：
*   **RSRS (阻力支撑相对强度)**：用 High/Low 回归斜率判断顶底，作为大盘或个股的“红绿灯”。
*   **通道突破 (Channel Breakout)**：对于 `acc` 类策略，增加 `Price > Max(Price, 20d)` 条件，能大幅提高追涨胜率。
*   **双动量 (Dual Momentum)**：增加 `Price > MA60` 等绝对收益过滤器，防止在熊市中买入“跌得最少”的垃圾。

### 3. 路径平滑度 (Information Discreteness / ID)
*   **原理**：动量的质量取决于它是“连续上涨”还是“跳跃上涨”。ID 指标用来衡量这种区分。
*   **公式**： $$ ID = sign(Ret) \times \frac{PositiveDays - NegativeDays}{Volatility} $$ 或者简化版（Frog-in-the-pan）： $$ Score = \text{Consistency} = \frac{|Return_{total}|}{\sum |Return_{daily}|} $$
*   **优势**：比 $R^2$ 更直观地衡量“稳步推升”。那些每天涨0.5%连涨20天的标的，得分会远高于一天涨10%休息19天的标的。

这些研究成果为后续开发 `ETF_wy04` 或 `ETF_pro` 提供了理论基础。

## 四、 进阶评分研究：如何兼容“疯牛”与“慢牛”？

针对用户关于“如何兼顾指数级加速（疯牛）与每日稳步上涨（慢牛）”的提问，传统的 $Slope \times R^2$ 往往难以两全（R2惩罚非线性加速）。我们推荐以下方案：

### 推荐方案：索提诺动量 (Sortino Momentum)

**核心逻辑**：波动不一定是坏事，只有向下的波动才是风险。
*   **疯牛**：虽然波动巨大，但全是向上波动。
*   **慢牛**：波动极小，且无向下波动。

两者在 **下行偏差 (Downside Deviation)** 这一指标上是一致的（都极低）。

**公式**：
$$ Score = \frac{Return_{25d}}{DownsideDeviation} $$

**优势**：
1.  **慢牛（稳）**：下行偏差 $\approx 0$，分母微小 $\rightarrow$ **得分极高**。
2.  **疯牛（快）**：虽然暴涨，但只要不回撤，下行偏差也 $\approx 0$ $\rightarrow$ **得分极高**。
3.  **猴市（乱）**：有涨有跌，下行偏差大 $\rightarrow$ **得分低**。

这是一个“只惩罚下跌，不惩罚上涨”的上帝指标，能完美统摄两种强势形态。

### 2. 二次回归瞬时速度 (Quadratic Velocity)
核心逻辑：既然直线拟合 (Linear) 无法描述加速，那就用抛物线拟合 (Quadratic)。

模型： $$ Price_t = a \cdot t^2 + b \cdot t + c $$
评分公式：求当天的瞬时斜率 (导数) $$ Score = \text{Derivative}(t=0) = 2 \cdot a \cdot t + b $$ 或者加入 $R^2_{quad}$ (二次回归的拟合度)。
表现：
加速 ($a>0$)：瞬时速度会随着时间 $t$ 变得非常大，给予高分。
匀速 ($a \approx 0$)：退化为线性回归，给予正常分。
减速 ($a<0$)：即使当前在涨，但速度在衰减，得分会降低（提前预警）。
评价：数学上最严谨的“加速度”描述，能比线性回归早3-5天捕捉到主升浪。

